<%= javascript_include_tag '/plugins/gamification/slick.min.js' %>
<%= stylesheet_link_tag '/plugins/gamification/slick.css' %>
<%= stylesheet_link_tag '/plugins/gamification/slick-theme.css' %>

<% extend GamificationPlugin::DashboardHelper %>

<div class="gamification">
  <h1><%= _('Gamification Dashboard for %s' % @target.identifier) %></h1>

  <div>
    <h3> <%= _('Level') %></h3>
    <%= level_chart(@target) %>
  </div>

  <div class="scores">
    <h3><%= _('Score') %></h3>
    <% Merit::PointRules::AVAILABLE_RULES.each do |category, setting| %>
      <div class="score <%= category %>">
        <span class="label"><%= _('%s: ' % category) %></span>
        <span class="value"><%= @target.points(:category => category) %></span>
      </div>
    <% end %>
    <div class="score total">
      <span class="label"><%= _('Total: ') %></span>
      <span class="value"><%= @target.points %></span>
    </div>
  </div>
  <div class="badges">
    <h3><%= _('Badges') %></h3>
    <ul class="badge-list">
      <% environment.gamification_plugin_badges.each do |badge| %>
        <li class="badge <%= badge.name %> <%= @target.badges.include?(badge) ? 'earned' : 'not-earned' %>">
          <div class="badge">
            <div class="image <%= badge.name %>"></div>
            <div class="description"><%= badge.description %></div>
            <div class="level"><%= _('Level %s' % badge.level) %></div>
          </div>
        </li>
      <% end %>
    </ul>
  </div>
</div>

<script>
$('.gamification .badge-list').slick({
  dots: true,
  infinite: false,
  speed: 300,
  slidesToShow: 3,
  slidesToScroll: 1,
});
</script>
